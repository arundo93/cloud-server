import{r as o,j as e,d as k,R as F,p,i as v,e as _,f as b,h as y,u as L,b as N,A as E}from"./images-B-9O_Acr.js";const S="data:image/svg+xml,%3csvg%20width='80'%20height='80'%20viewBox='0%200%2080%2080'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='40'%20cy='20'%20r='6.5'%20fill='%23F8F6ED'%20stroke='black'%20stroke-width='3'/%3e%3ccircle%20cx='40'%20cy='40'%20r='6.5'%20fill='%23F8F6ED'%20stroke='black'%20stroke-width='3'/%3e%3ccircle%20cx='40'%20cy='60'%20r='6.5'%20fill='%23F8F6ED'%20stroke='black'%20stroke-width='3'/%3e%3c/svg%3e",I="data:image/svg+xml,%3csvg%20width='80'%20height='80'%20viewBox='0%200%2080%2080'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M36.5%2046V18.5H43.5V46C43.5%2047.3807%2044.6193%2048.5%2046%2048.5H50.7974L41.7145%2059.3995C40.3575%2061.0279%2041.5155%2063.5%2043.635%2063.5H63.5V64.5H16.5V63.5H36.365C38.4846%2063.5%2039.6424%2061.0279%2038.2855%2059.3995L29.2026%2048.5H34C35.3807%2048.5%2036.5%2047.3807%2036.5%2046ZM51.4808%2047.6799L51.4801%2047.6808L51.4808%2047.6799Z'%20fill='%23F8F6ED'%20stroke='black'%20stroke-width='3'/%3e%3c/svg%3e",D="data:image/svg+xml,%3csvg%20width='80'%20height='80'%20viewBox='0%200%2080%2080'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M14.4395%2049.1875L36.8032%2062.0992C39.673%2063.756%2043.3425%2062.7728%2044.9994%2059.903L63.1016%2028.549C63.6539%2027.5925%2063.3261%2026.3693%2062.3696%2025.817L60.6375%2024.817C59.6809%2024.2647%2058.4577%2024.5925%2057.9055%2025.549L41.8032%2053.4389C40.6986%2055.3521%2038.2523%2056.0076%2036.3391%2054.903L16.4003%2043.3913C15.2524%2042.7286%2013.7845%2043.1219%2013.1218%2044.2698C12.1277%2045.9916%2012.7177%2048.1934%2014.4395%2049.1875Z'%20fill='%2300FF00'/%3e%3c/svg%3e",H="data:image/svg+xml,%3csvg%20width='80'%20height='80'%20viewBox='0%200%2080%2080'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M20.648%2058.3191L24.5995%2045.9482L54.9086%2015.6391L63.8528%2023.6655L36.2782%2051.2401L32.7507%2048.1247C31.7609%2047.2505%2030.2619%2047.297%2029.328%2048.2308L29.0307%2048.5281C28.0113%2049.5475%2028.063%2051.2154%2029.1435%2052.1697L31.7166%2054.4422L20.648%2058.3191ZM32.5217%2054.1602L32.521%2054.1605L32.5217%2054.1602Z'%20fill='%23F8F6ED'%20stroke='black'%20stroke-width='3'/%3e%3crect%20x='13.5'%20y='62.5978'%20width='49'%20height='3'%20fill='black'%20stroke='black'/%3e%3c/svg%3e",R="data:image/svg+xml,%3csvg%20width='80'%20height='80'%20viewBox='0%200%2080%2080'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='16'%20y='21'%20width='48'%20height='2'%20rx='1'%20stroke='%23FF0000'%20stroke-width='2'/%3e%3cpath%20d='M52%2064H28C25.2386%2064%2023%2061.7614%2023%2059V29C23%2028.4477%2023.4477%2028%2024%2028H24.2353C24.7876%2028%2025.2353%2028.4477%2025.2353%2029V57C25.2353%2059.7614%2027.4739%2062%2030.2353%2062H49.7647C52.5261%2062%2054.7647%2059.7614%2054.7647%2057V29C54.7647%2028.4477%2055.2124%2028%2055.7647%2028H56C56.5523%2028%2057%2028.4477%2057%2029V59C57%2061.7614%2054.7614%2064%2052%2064Z'%20fill='%23FF0000'%20stroke='%23FF0000'%20stroke-width='2'/%3e%3crect%20x='34'%20y='33'%20width='2'%20height='22'%20rx='1'%20stroke='%23FF0000'%20stroke-width='2'/%3e%3crect%20x='44'%20y='33'%20width='2'%20height='22'%20rx='1'%20stroke='%23FF0000'%20stroke-width='2'/%3e%3cpath%20d='M32%2016C32%2014.8954%2032.8954%2014%2034%2014H46C47.1046%2014%2048%2014.8954%2048%2016V20H32V16Z'%20fill='%23FF0000'/%3e%3c/svg%3e",V="modulepreload",O=function(r){return"/"+r},w={},M=function(n,h,i){let m=Promise.resolve();if(h&&h.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),a=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));m=Promise.allSettled(h.map(l=>{if(l=O(l),l in w)return;w[l]=!0;const s=l.endsWith(".css"),d=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const t=document.createElement("link");if(t.rel=s?"stylesheet":V,s||(t.as="script"),t.crossOrigin="",t.href=l,a&&t.setAttribute("nonce",a),document.head.appendChild(t),s)return new Promise((f,u)=>{t.addEventListener("load",f),t.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${l}`)))})}))}function g(c){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=c,window.dispatchEvent(a),!a.defaultPrevented)throw c}return m.then(c=>{for(const a of c||[])a.status==="rejected"&&g(a.reason);return n().catch(g)})},B={enable:!1,colorSpace:"color"};function A({fileUrl:r}){const[n,h]=o.useState(null),[i,m]=o.useState(B),[g,c]=o.useState(null),a=o.useRef(null),l=o.useId(),s=o.useCallback(()=>{m(t=>({...t,colorSpace:t.colorSpace==="color"?"gray":"color"}))},[m]);o.useEffect(()=>{if(i.enable){if(i.colorSpace==="color")n.imshow(l,g);else if(i.colorSpace==="gray"){let t=new n.Mat;n.cvtColor(g,t,n.COLOR_RGBA2GRAY,0),n.imshow(l,t),t.delete()}}},[i,g,l]);const d=()=>{if(n)try{c(n.imread(a.current)),m(t=>({...t,enable:!0}))}catch(t){console.log(t)}};return o.useEffect(()=>{(async()=>{const{cvFactory:f}=await M(async()=>{const{cvFactory:u}=await import("./opencv-BfzHwUv7.js");return{cvFactory:u}},[]);f.then(u=>{h(u),console.log("CV loaded!")})})()},[]),e.jsxs("div",{className:"file-content",children:[e.jsx("div",{className:"image__controls",children:e.jsxs("div",{className:"image__controls-toggle",children:[e.jsx("div",{children:"Color"}),e.jsx("input",{type:"checkbox",className:"toggle-button",onChange:s}),e.jsx("div",{children:"Gray"})]})}),!!n&&e.jsxs(e.Fragment,{children:[e.jsx("img",{ref:a,src:r,onLoad:d}),e.jsx("canvas",{id:l})]})]})}function P({fileName:r,fileUrl:n,deleteFile:h,renameFile:i}){const[m,g]=o.useState(!1),[c,a]=o.useState(!1),[l,s]=o.useState(""),[d,t]=o.useState(!1),f=o.useCallback(()=>{g(x=>!x)},[g]),u=o.useCallback(({target:x})=>{s(k(x.value))},[s]),C=o.useCallback(()=>{c?(i(r,l),a(!1),f()):(s(r),a(!0))},[c,l,a,i,f,s]),j=o.useCallback(()=>{t(x=>!x)},[t]);return e.jsxs(F.Fragment,{children:[e.jsxs("div",{className:"file",children:[e.jsx("div",{className:"file__attribute",children:e.jsx("svg",{viewBox:"0 0 12 16",xmlns:"http://www.w3.org/2000/svg",className:"file__icon",style:{width:"16px",height:"16px"},children:e.jsx("path",{d:"M8 0H1.6C.72 0 .008.72.008 1.6L0 14.4c0 .88.712 1.6 1.592 1.6H11.2c.88 0 1.6-.72 1.6-1.6V4.8L8 0zm1.6 12.8H3.2v-1.6h6.4v1.6zm0-3.2H3.2V8h6.4v1.6zm-2.4-4V1.2l4.4 4.4H7.2z"})})}),e.jsx("div",{className:"file__attribute",style:{flex:"3 1 30px",overflow:"hidden"},onClick:()=>!c&&j(),children:c?e.jsx("input",{value:l,onChange:u}):!!r&&r||"Без имени"}),e.jsx("div",{className:"file__attribute",children:e.jsxs("div",{className:"file__controls",children:[m&&e.jsxs(e.Fragment,{children:[e.jsx("a",{href:n,download:r,onClick:f,children:e.jsx("div",{className:"file__controls-item",children:e.jsx("img",{src:I})})}),e.jsx("div",{className:"file__controls-item",onClick:C,children:c?e.jsx("img",{src:D}):e.jsx("img",{src:H})}),e.jsx("div",{className:"file__controls-item",onClick:()=>h(r),children:e.jsx("img",{src:R})})]}),e.jsx("div",{className:"file__controls-item",children:e.jsx("img",{src:S,onClick:f})})]})})]}),d&&e.jsx(A,{fileUrl:n})]})}function T({uploadFiles:r}){const[n,h]=o.useState(!1),i=o.useId(),m=o.useCallback(()=>{h(!1)},[h]),g=o.useCallback(l=>{l.preventDefault(),h(!0)},[h]),c=o.useCallback(l=>{l.preventDefault(),h(!1),r(l.dataTransfer.files),console.log(l.dataTransfer.files)},[h]);function a(l){l.target.files&&r(l.target.files),console.log(l.target.files)}return e.jsxs("label",{className:"file"+(n?" addfile-dragged":""),htmlFor:i,onDragLeave:m,onDragOver:g,onDrop:c,children:[e.jsxs("div",{className:"explorer__addfile",children:[e.jsx("img",{className:"addfile-icon",src:p}),e.jsx("div",{className:"addfile-text",children:"Нажмите или перетащите файл сюда"})]}),e.jsx("input",{className:"addfile-input",type:"file",multiple:!0,id:i,onChange:a})]})}const Z="/assets/arrow-qCuS77Qj.svg";function $(){const[r,n]=o.useState([]),i=new URLSearchParams(window.location.search).get("name"),m=o.useCallback(s=>{n(d=>v(d.filter(t=>t!==s),s))},[n]),g=o.useCallback(s=>{i&&_(s,i).then(d=>{console.log(d),d.success&&n(t=>t?t.filter(f=>f!==s):[])})},[n]),c=o.useCallback((s,d)=>{i&&b(s,d,i).then(t=>{console.log(t),t.success&&n(f=>v(f.filter(u=>u!==s),d))})},[n]);async function a(s){if(i)for(let d of s)await L(d,i).then(t=>{console.log(t),t.success&&m(d.name)})}function l(s){s.target.files&&a(s.target.files),console.log(s.target.files)}return o.useEffect(()=>(i&&y(i).then(s=>{typeof s<"u"&&s.length&&n(s)}),()=>{n([])}),[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"controls",children:[e.jsxs("div",{className:"controls__item",onClick:()=>{window.location.href="/"},children:[e.jsx("img",{className:"controls__item-icon",style:{rotate:"-90deg"},src:Z}),e.jsx("div",{className:"controls__item-text",children:"Назад"})]}),e.jsxs("label",{className:"controls__item",htmlFor:"controls-input-file",children:[e.jsx("img",{className:"controls__item-icon",src:p}),e.jsx("div",{className:"controls__item-text",children:"Добавить файл"}),e.jsx("input",{type:"file",multiple:!0,id:"controls-input-file",style:{display:"none"},onChange:l})]})]}),e.jsxs("div",{className:"file-explorer",children:[!!r&&!!r.length&&r.map(s=>e.jsx(P,{fileName:s,fileUrl:`${window.location.origin}/img/${i}/${s}`,deleteFile:g,renameFile:c},s)),e.jsx(T,{uploadFiles:a})]})]})}N.createRoot(document.getElementById("root")).render(e.jsx(E,{children:e.jsx($,{})}));
